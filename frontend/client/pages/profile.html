<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>TSL Freight Movers INC.</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="../../assets/img/f-icon.png" rel="icon">
  <link href="../../assets/img/l-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Amatic+SC:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../../assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="../../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="../../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="../../client/styles/profile.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css" />
  <link rel="stylesheet" href="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.css">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.js"></script>

</head>

<body>
  <!-- Preloader -->
  <div id="preloader"></div>
  <!-- ======= Navbar ======= -->
  <nav>
    <div class="logo-name">
      <div class="logo-image">
        <img src="../../assets/img/logo.png" alt="TSL Logo">
      </div>
      <span class="logo_name">TSL FREIGHT<br>MOVERS, INC.</span>
    </div>

    <div class="menu-items">
      <ul class="nav-links">
        <li>
          <a href="./clientdashboard.html">
            <i class="uil uil-estate"></i>
            <span class="link-name">Dashboard</span>
          </a>
        </li>
        <li>
          <a href="./bookings.html">
            <i class="uil uil-schedule"></i>
            <span class="link-name">Book</span>
          </a>
        </li>
        <li>
          <a href="./shipment.html">
            <i class="uil uil-ship"></i>
            <span class="link-name">Shipments</span>
          </a>
        </li>
        <li>
          <a href="./history.html">
            <i class="uil uil-history"></i>
            <span class="link-name">History</span>
          </a>
        </li>
        <li>
          <a href="./invoices.html">
            <i class="uil uil-receipt"></i>
            <span class="link-name">Invoices</span>
          </a>
        </li>
      </ul>

      <ul class="logout-mode">
        <li>
          <a href="../../login.html">
            <i class="uil uil-signout"></i>
            <span class="link-name">Logout</span>
          </a>
        </li>
      </ul>
    </div>
  </nav>
  <!-- End Navbar -->

  <!-- Dashboard -->
  <main class="dashboard">
    <!-- Dashboard Top Bar -->
    <div class="top d-flex align-items-center justify-content-between px-3 py-2">
      <i class="fas fa-bars hamburger-menu me-2" id="hamburgerMenu"></i>
      <div class="d-flex flex-column">
        <h4 class="dashboard-title mb-0">Profile</h4>
        <p class="dashboard-date mb-0" id="current-date" data-field="currentDate">—</p>
      </div>

      <!-- Profile and Notifications -->
      <div class="profile-dropdown position-relative">
        <div class="profile-wrapper position-relative d-inline-block">
          <i class="fas fa-user-circle profile-icon" id="profileIcon"></i>
          <span id="notifCount" class="notif-badge">0</span>
        </div>
        <div class="dropdown-menu" id="profileDropdown">
          <a href="./profile.html"><i class="uil uil-user"></i> Profile</a>
          <a href="./notifications.html"><i class="uil uil-bell"></i> Notifications</a>
        </div>
      </div>
    </div>

    <section>
      <div class="container py-5" style="max-width: 1200px; width: 100%;">
        <div class="row justify-content-center">
          <div class="col-md-10">
            <h4 class="mb-1">User Profile</h4>
            <p class="text-muted" style="font-size: 0.95rem;">Manage and review your personal and company information.</p>

            <div class="row equal-height">
              <div class="col-md-4 text-center">
                <div class="info-card full-height d-flex flex-column justify-content-center align-items-center py-4">
                  <div class="profile-image mb-4">
                    <i class="fa-solid fa-user fa-5x text-secondary"></i>
                  </div>
                  <h5 class="mb-2">Name</h5>
                  <button class="btn btn-change-photo" onclick="openPhotoModal()">Change Photo</button>
                </div>
              </div>

              <div class="col-md-8">
                <div class="info-card full-height">
                  <div class="section-title">General Information</div>
                  <!-- General Information (read-only) -->
                    <div class="row">
                      <div class="col-md-6 mb-3">
                        <label class="form-label">Company Name</label>
                        <input id="viewCompanyName" type="text" class="form-control" value="TSL Freight Movers Inc." disabled>
                      </div>
                      <div class="col-md-6 mb-3">
                        <label class="form-label">Contact Person</label>
                        <input id="viewContactPerson" type="text" class="form-control" value="Name" disabled>
                      </div>
                      <div class="col-md-6 mb-3">
                        <label class="form-label">Contact Number</label>
                        <input id="viewContactNumber" type="text" class="form-control" value="+965 1234 5678" disabled>
                      </div>
                      <div class="col-md-6 mb-3">
                        <label class="form-label">Email</label>
                        <input id="viewEmail" type="email" class="form-control" value="tsl@email.com" disabled>
                      </div>
                      <div class="col-md-12 mb-3">
                        <label class="form-label">Address</label>
                        <input id="viewAddress" type="text" class="form-control" value="location" disabled>
                      </div>
                    </div>
                  <button class="btn btn-primary mt-2" onclick="openEditModal()">Edit</button>
                </div>
              </div>
            </div>

            <div class="info-card">
              <div class="section-title">Security</div>
              <div class="row align-items-end">
                <div class="col-md-4 mb-3">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" value="address@email.com" disabled>
                </div>
                <div class="col-md-4 mb-3">
                  <label class="form-label">Password</label>
                  <button class="btn btn-primary d-block w-100" onclick="openPasswordModal()">Change Password</button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!-- Change Password Modal -->
<div id="changePasswordModal" class="modal">
  <div class="modal-content">
    <span class="exit" onclick="closePasswordModal()">&times;</span>
    <h5 class="mb-3">Change Password</h5>
    <form class="row g-3" id="changePasswordForm">
      <div class="col-12">
        <label class="form-label">Current Password</label>
        <input type="password" name="oldPassword" class="form-control" placeholder="Enter current password" required>
      </div>
      <div class="col-12">
        <label class="form-label">New Password</label>
        <input type="password" name="newPassword" class="form-control" placeholder="Enter new password" required>
      </div>
      <div class="col-12">
        <label class="form-label">Confirm New Password</label>
        <input type="password" name="confirmPassword" class="form-control" placeholder="Confirm new password" required>
      </div>
      <div class="col-12 text-end">
        <button type="submit" class="btn btn-primary">Save Password</button>
      </div>
    </form>
  </div>
</div>

    <!-- Edit Profile Modal -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="exit" onclick="closeModal('editModal')">&times;</span>
    <h5 class="mb-3">Edit Profile</h5>
    <form class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Company Name</label>
        <input id="companyNameInput" type="text" class="form-control" value="TSL Freight Movers Inc.">
      </div>
      <div class="col-md-6">
        <label class="form-label">Contact Person</label>
        <input id="contactPersonInput" type="text" class="form-control" value="Name">
      </div>
      <div class="col-md-6">
        <label class="form-label">Contact Number</label>
        <input id="contactNumberInput" type="text" class="form-control" value="+965 1234 5678">
      </div>
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input id="emailInput" type="email" class="form-control" value="tsl@email.com">
      </div>
      <div class="col-md-12">
        <label class="form-label">Address</label>
        <input id="addressInput" type="text" class="form-control" value="location">
      </div>
      <div class="col-md-6">
        <label class="form-label">Password</label>
        <input id="passwordInput" type="password" class="form-control">
      </div>
      <div class="col-md-6">
        <label class="form-label">Confirm Password</label>
        <input id="confirmPasswordInput" type="password" class="form-control">
      </div>
      <div class="col-12 text-end">
        <button type="submit" class="btn btn-primary">Save Changes</button>
      </div>
    </form>
  </div>
</div>

    <!-- Change Photo Modal -->
    <div id="photoModal" class="modal">
      <div class="modal-content text-center" style="max-width: 400px;">
        <h5 class="mb-4 mt-3">Change Profile Photo</h5>
        <div class="modal-option" onclick="triggerFileInput()">Upload Photo</div>
        <div class="modal-option remove" onclick="removePhoto()">Remove Current Photo</div>
        <div class="modal-option cancel" onclick="closePhotoModal()">Cancel</div>
        <input type="file" id="uploadPhoto" style="display: none;" onchange="uploadPhoto()">
      </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
      <div class="modal-content">
        <button class="btn btn-primary d-block w-100" onclick="openPasswordModal()">Change Password</button>
        <h5 class="mb-3">Change Password</h5>
        <form class="row g-3">
          <div class="col-12">
            <label class="form-label">Current Password</label>
            <input type="password" class="form-control" placeholder="Enter current password">
          </div>
          <div class="col-12">
            <label class="form-label">New Password</label>
            <input type="password" class="form-control" placeholder="Enter new password">
          </div>
          <div class="col-12">
            <label class="form-label">Confirm New Password</label>
            <input type="password" class="form-control" placeholder="Confirm new password">
          </div>
          <div class="col-12 text-end">
            <button type="submit" class="btn btn-primary">Save Password</button>
          </div>
        </form>
      </div>
    </div>


<div id="successModal" class="status-modal success">
  <div class="status-card">
    <span class="close-btn" onclick="closeModal('successModal')">&times;</span>
    <div class="status-icon">
      <i class="fas fa-check"></i>
    </div>
    <h2>Profile Updated!</h2>
    <p>Your profile was updated successfully.</p>
    <button class="ok-btn" onclick="closeModal('successModal')">OK</button>
  </div>
</div>

<div id="errorModal" class="status-modal error">
  <div class="status-card">
    <span class="close-btn" onclick="closeModal('errorModal')">&times;</span>
    <div class="status-icon">
      <i class="fas fa-times"></i>
    </div>
    <h2>Update Failed!</h2>
    <p>Could not update your profile. Please try again.</p>
    <button class="ok-btn" onclick="closeModal('errorModal')">OK</button>
  </div>
</div>




    <!-- Change Photo Modal with Cropper -->
<div id="photoModal" class="modal">
  <div class="modal-content text-center" style="max-width: 800px;">
    <span class="exit" onclick="closePhotoModal()">&times;</span>
    <h5 class="mb-3">Adjust Profile Photo</h5>

    <!-- Image area -->
    <div class="row g-3">
      <div class="col-md-8">
        <div class="ratio ratio-1x1 border bg-light">
          <img id="cropperImage" alt="Preview" style="max-width:100%;" />
        </div>
      </div>
      <div class="col-md-4 d-flex flex-column align-items-center">
        <canvas id="circlePreview" width="200" height="200" class="rounded-circle border"></canvas>
        <small class="text-muted mt-2">Circular Preview</small>
      </div>
    </div>

    <!-- Controls -->
    <div class="mt-3">
      <button class="btn btn-secondary" onclick="cropper.zoom(0.1)">Zoom In</button>
      <button class="btn btn-secondary" onclick="cropper.zoom(-0.1)">Zoom Out</button>
      <button class="btn btn-secondary" onclick="cropper.rotate(-90)">Rotate -90°</button>
      <button class="btn btn-secondary" onclick="cropper.rotate(90)">Rotate +90°</button>
      <button class="btn btn-secondary" onclick="cropper.reset()">Reset</button>
    </div>

    <!-- Confirm / Cancel -->
    <div class="mt-3">
      <button class="btn btn-primary" id="confirmCropBtn">Save & Upload</button>
      <button class="btn btn-outline-secondary" onclick="closePhotoModal()">Cancel</button>
    </div>

    <!-- Hidden file input -->
    <input type="file" id="uploadPhoto" accept="image/*" style="display:none;">
  </div>
</div>

  </main>

  <!-- Scripts -->
  <script>
    function openModal() { document.getElementById("editModal").style.display = "block"; }
    function closeModal() { document.getElementById("editModal").style.display = "none"; }
    function openPhotoModal() { document.getElementById("photoModal").style.display = "block"; }
    function closePhotoModal() { document.getElementById("photoModal").style.display = "none"; }
    function openPasswordModal() { document.getElementById("changePasswordModal").style.display = "block"; }
    function closePasswordModal() { document.getElementById("changePasswordModal").style.display = "none"; }
    function triggerFileInput() { document.getElementById("uploadPhoto").click(); }
    function uploadPhoto() {
      const fileInput = document.getElementById("uploadPhoto");
      const file = fileInput.files[0];
      if (file) {
        alert("Photo uploaded: " + file.name);
        closePhotoModal();
      } else {
        alert("Please select a photo to upload.");
      }
    }
    function removePhoto() {
      alert("Profile photo removed.");
      closePhotoModal();
    }
    window.onclick = function(event) {
      if (event.target === document.getElementById("editModal")) closeModal();
      if (event.target === document.getElementById("photoModal")) closePhotoModal();
      if (event.target === document.getElementById("changePasswordModal")) closePasswordModal();
    };
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const currentDateElement = document.getElementById("current-date");

      function updateDate() {
        const now = new Date();
        const options = {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        };
        currentDateElement.textContent = now.toLocaleDateString('en-US', options);
      }

      updateDate(); // Initial call
    });
  </script>
  <script>
  window.addEventListener("load", function () {
    const preloader = document.getElementById("preloader");
    if (preloader) {
      preloader.style.opacity = "0";
      preloader.style.visibility = "hidden";
      setTimeout(() => preloader.remove(), 600);
    }
  });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../script/profile.js"></script>
</body>
</html>
